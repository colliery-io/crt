---
id: add-theme-submenu-to-window-menu
level: task
title: "Add Theme submenu to Window menu with dynamic theme list"
short_code: "CRT-T-0158"
created_at: 2025-12-31T14:37:49.099493+00:00
updated_at: 2025-12-31T14:57:04.382016+00:00
parent: CRT-I-0025
blocked_by: []
archived: false

tags:
  - "#task"
  - "#phase/completed"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0025
---

# Add Theme submenu to Window menu with dynamic theme list

## Parent Initiative
[[CRT-I-0025]] - Per-Window Theme Switching

## Objective

Add a "Theme" submenu to the macOS Window menu that lists all available themes from the registry. Selecting a theme applies it to the focused window immediately.

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

- [ ] Window menu has "Theme >" submenu
- [ ] Submenu dynamically populated from `ThemeRegistry::list_themes()`
- [ ] Current window's theme has checkmark indicator
- [ ] Selecting a theme dispatches `MenuAction::SetTheme(theme_name)`
- [ ] Event handler calls `focused_window.set_theme()` with selected theme
- [ ] Theme change applies immediately (no restart required)

## Implementation Notes

### Technical Approach

**Menu structure:**
```
Window
├── Minimize
├── Zoom
├── ─────────
├── Theme ▸
│   ├── ✓ synthwave
│   ├── nyancat
│   ├── catppuccin
│   └── gruvbox
└── ─────────
```

**Menu building (`src/menu.rs`):**
```rust
pub enum MenuAction {
    // ... existing actions ...
    SetTheme(String),  // theme name
}

fn build_theme_submenu(theme_names: &[&str], current_theme: &str) -> Submenu {
    let submenu = Submenu::new("Theme", true);
    for name in theme_names {
        let item = CheckMenuItem::new(name, true, name == current_theme, None);
        submenu.append(&item);
    }
    submenu
}
```

**Event handling (`src/main.rs`):**
```rust
MenuAction::SetTheme(name) => {
    if let Some(theme) = self.theme_registry.get_theme(&name) {
        if let Some(state) = self.focused_window_mut() {
            state.set_theme(&name, theme.clone());
        }
    }
}
```

### Files to Modify
- `src/menu.rs`: Add `SetTheme` action, build theme submenu
- `src/main.rs`: Handle `SetTheme` action, pass theme list to menu builder

### Dependencies
- Requires CRT-T-0156 (ThemeRegistry)
- Requires CRT-T-0157 (per-window theme state)

### Considerations
- Menu is built once at startup; may need rebuild on theme directory changes
- CheckMenuItem state needs updating when window focus changes

## Status Updates

*To be added during implementation*