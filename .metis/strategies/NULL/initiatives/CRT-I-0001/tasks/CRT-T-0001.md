---
id: research-existing-css-to-shader
level: task
title: "Research existing CSS-to-shader approaches"
short_code: "CRT-T-0001"
created_at: 2025-11-25T01:30:45.090997+00:00
updated_at: 2025-11-25T01:43:49.507802+00:00
parent: CRT-I-0001
blocked_by: []
archived: false

tags:
  - "#task"
  - "#phase/completed"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0001
---

# Research existing CSS-to-shader approaches

Parent: [[CRT-I-0001]]

## Objective

Survey existing approaches for bridging declarative styling (CSS-like) with GPU shader programs to inform our architecture decision.

## Acceptance Criteria

## Acceptance Criteria

- [x] Document existing CSS-to-shader approaches in web/game ecosystems
- [x] Identify relevant Rust ecosystem libraries
- [x] Understand typical CRT shader parameters and patterns
- [x] Summarize trade-offs for each approach category

---

## Research Findings

### 1. Web: CSS Custom Properties to Shader Uniforms

Modern approach uses CSS custom properties to dynamically set WebGL shader uniforms. Colors and values defined in CSS can be read by JavaScript and passed to shaders at runtime.

**Pros**: Familiar CSS syntax, integrates with design systems, supports theming
**Cons**: Requires JavaScript bridge, web-specific

**Source**: [How to Set WebGL Shader Colors with CSS](https://nmattia.com/posts/2025-01-29-shader-css-properties/)

### 2. Rust/wgpu: Bind Groups and Uniforms

Standard wgpu pattern: define uniform structs in Rust, create bind groups, update GPU buffers from CPU code. Shaders written in WGSL reference uniforms by binding index.

**Key crates**:
- `wgpu` - GPU abstraction layer
- `wgsl_bindgen` - generates Rust types matching shader uniforms
- `encase`/`bytemuck` - handle memory layout/alignment

**Pros**: Type-safe, compile-time validation, native Rust workflow
**Cons**: Manual synchronization between Rust structs and WGSL

**Source**: [wgpu uniform examples](https://wgpu.rs/doc/wgpu_examples/uniform_values/index.html)

### 3. Shader Composition: naga_oil

`naga_oil` provides modular shader composition - combine shader modules, create imports/exports between them. Built on `naga` (shader translation).

**Pros**: Composable effects, code reuse across shaders
**Cons**: Still requires manual WGSL authoring

**Source**: [naga_oil on lib.rs](https://lib.rs/crates/naga_oil)

### 4. Programmatic Shader Generation: naga IR

Build shaders programmatically using naga's intermediate representation, then emit WGSL/SPIR-V. Allows Rust code to construct shaders dynamically.

**Pros**: Full programmatic control, can generate shaders from config
**Cons**: Complex API, verbose for simple cases

**Source**: [naga on GitHub](https://github.com/gfx-rs/naga)

### 5. rust-gpu: Shaders in Rust

Write shader code in Rust, compile to SPIR-V via custom rustc backend. Share types between CPU and GPU code.

**Pros**: Single language, type sharing, Rust tooling
**Cons**: Experimental, limited subset of Rust, complex build setup

**Source**: [rust-gpu on GitHub](https://github.com/Rust-GPU/rust-gpu)

### 6. Node-based Shader Graphs (Unity/Godot)

Visual node graphs for composing effects. Each node is a shader operation, connections define data flow.

**Pros**: Artist-friendly, visual debugging, easy composition
**Cons**: Requires UI tooling, not directly applicable to Rust CLI

**Source**: [Unity Shader Graph](https://unity.com/features/shader-graph)

### 7. Taffy: CSS Layout (Not Styling)

Taffy implements CSS Flexbox/Grid layout in Rust. Useful for UI positioning but doesn't handle visual styling or shaders.

**Relevant for**: Terminal UI layout, not shader pipeline

**Source**: [Taffy on GitHub](https://github.com/DioxusLabs/taffy)

---

## CRT Shader Parameters (Reference)

Typical uniforms for CRT effects:

| Parameter | Type | Purpose |
|-----------|------|---------|
| `resolution` | vec2 | Virtual CRT resolution |
| `scanline_strength` | float | Scanline darkness (0.0-1.0) |
| `phosphor_mask` | float | RGB subpixel visibility |
| `glow_intensity` | float | Bloom/halation strength |
| `curvature` | float | Screen barrel distortion |
| `brightness` | float | Overall brightness |
| `contrast` | float | Color contrast |

**Source**: [Godot CRT Shader](https://godotshaders.com/shader/crt-display-shader-pixel-mask-scanlines-glow-godot-4-4-1/)

---

## Recommendations for Prototyping

| Approach | Prototype? | Rationale |
|----------|------------|-----------|
| **A: Static WGSL + Uniforms** | Yes | Simplest, proven pattern, good baseline |
| **B: naga IR generation** | Yes | Enables CSS-driven shader generation |
| **C: naga_oil composition** | Maybe | Good for effect layering, less relevant for CSS mapping |
| **rust-gpu** | No | Too experimental for production use |

---

## Status

**Completed**: 2025-11-25