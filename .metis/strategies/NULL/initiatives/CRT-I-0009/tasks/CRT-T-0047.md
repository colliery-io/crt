---
id: render-tab-bar-via-vello-as-proof
level: task
title: "Render tab bar via vello as proof of concept"
short_code: "CRT-T-0047"
created_at: 2025-11-26T18:15:41.866766+00:00
updated_at: 2025-11-26T18:15:41.866766+00:00
parent: CRT-I-0009
blocked_by: []
archived: false

tags:
  - "#task"
  - "#phase/todo"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0009
---

# Render tab bar via vello as proof of concept

*This template includes sections for various types of tasks. Delete sections that don't apply to your specific use case.*

## Parent Initiative **[CONDITIONAL: Assigned Task]**

[[CRT-I-0009]]

## Objective

Replace the current custom tab bar shader rendering with vello-based rendering as a proof of concept for the hybrid architecture. This validates that vello integrates well with our pipeline.

## Acceptance Criteria

- [ ] Tab bar backgrounds rendered via vello
- [ ] Tab colors/gradients from theme applied
- [ ] Active tab visually distinct
- [ ] Close button rendered
- [ ] Visual parity with current tab bar
- [ ] Performance acceptable

## Implementation Notes

### Technical Approach

1. Build vello scene with tab bar shapes in `tab_bar/renderer.rs`
2. Use `scene.fill()` for tab backgrounds
3. Apply colors from theme
4. Render vello scene to texture
5. Composite vello texture in render pipeline

### Code Sketch

```rust
use vello::Scene;
use vello::kurbo::{RoundedRect, Rect};
use vello::peniko::{Color, Fill};

pub fn build_tab_bar_scene(
    scene: &mut Scene,
    tabs: &[Tab],
    layout: &TabLayout,
    theme: &Theme,
) {
    for (tab, rect) in tabs.iter().zip(layout.tab_rects()) {
        let color = if tab.is_active {
            theme.tab_active_color
        } else {
            theme.tab_inactive_color
        };
        
        let shape = RoundedRect::new(
            rect.x, rect.y,
            rect.x + rect.width, rect.y + rect.height,
            4.0, // corner radius
        );
        
        scene.fill(
            Fill::NonZero,
            vello::kurbo::Affine::IDENTITY,
            color,
            None,
            &shape,
        );
    }
}
```

### Current vs New Architecture

**Current:**
- `tab_bar.wgsl` shader renders solid color quads
- Vertices uploaded to GPU buffer
- Custom render pass

**New:**
- vello builds scene with shapes
- vello renders to texture
- Texture composited in final pass

### Dependencies

- CRT-T-0046 (vello setup) must be complete

### Files to Modify

- `crates/crt-renderer/src/tab_bar/renderer.rs` - Add vello scene building
- `src/render.rs` - Integrate vello texture in pipeline

## Status Updates

*To be added during implementation*