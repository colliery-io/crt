---
id: create-effects-module-with
level: task
title: "Create effects module with BackdropEffect trait and EffectsRenderer"
short_code: "CRT-T-0071"
created_at: 2025-11-27T14:03:59.406821+00:00
updated_at: 2025-11-27T14:19:41.047612+00:00
parent: CRT-I-0014
blocked_by: []
archived: false

tags:
  - "#task"
  - "#phase/completed"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0014
---

# Create effects module with BackdropEffect trait and EffectsRenderer

*This template includes sections for various types of tasks. Delete sections that don't apply to your specific use case.*

## Parent Initiative

[[CRT-I-0014]] - Vello-Powered Backdrop Effects System

## Objective

Create the foundational module structure for the backdrop effects system, including the `BackdropEffect` trait that all effects will implement and the `EffectsRenderer` that manages and renders multiple effects to a texture.

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

- [ ] Create `crates/crt-renderer/src/effects/mod.rs` with module structure
- [ ] Define `BackdropEffect` trait with `effect_type()`, `update()`, `render()`, `configure()` methods
- [ ] Define `EffectConfig` struct for passing CSS properties to effects
- [ ] Create `EffectsRenderer` struct that holds `Vec<Box<dyn BackdropEffect>>`
- [ ] Implement `EffectsRenderer::new()`, `update()`, `render()` methods
- [ ] `render()` builds a Vello scene and renders to texture via shared VelloRenderer
- [ ] Add `effects` module to `crates/crt-renderer/src/lib.rs`
- [ ] Code compiles with no errors

## Implementation Notes

### Technical Approach

```rust
// crates/crt-renderer/src/effects/mod.rs
pub mod renderer;

use vello::Scene;
use kurbo::Rect;

pub struct EffectConfig {
    pub properties: std::collections::HashMap<String, String>,
}

pub trait BackdropEffect: Send + Sync {
    fn effect_type(&self) -> &'static str;
    fn update(&mut self, dt: f32, time: f32);
    fn render(&self, scene: &mut Scene, bounds: Rect);
    fn configure(&mut self, config: &EffectConfig);
}
```

```rust
// crates/crt-renderer/src/effects/renderer.rs
pub struct EffectsRenderer {
    effects: Vec<Box<dyn BackdropEffect>>,
    vello_renderer: Arc<Mutex<Option<VelloRenderer>>>,
    texture: Option<wgpu::Texture>,
    time: f32,
}
```

### Dependencies
- Existing Vello integration in `gpu.rs` (lazy VelloRenderer)
- `vello`, `kurbo`, `peniko` crates already in workspace

### Files to Create
- `crates/crt-renderer/src/effects/mod.rs`
- `crates/crt-renderer/src/effects/renderer.rs`

## Status Updates

*To be added during implementation*