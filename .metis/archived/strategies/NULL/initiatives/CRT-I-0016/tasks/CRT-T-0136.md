---
id: add-eventoverride-and-spritepatch
level: task
title: "Add EventOverride and SpritePatch/Overlay structs to crt-theme"
short_code: "CRT-T-0136"
created_at: 2025-12-29T18:52:00.444772+00:00
updated_at: 2025-12-29T19:00:22.209562+00:00
parent: CRT-I-0016
blocked_by: []
archived: true

tags:
  - "#task"
  - "#phase/completed"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0016
---

# Add EventOverride and SpritePatch/Overlay structs to crt-theme

**Phase 1** - Foundation data structures for event-driven theming.

## Objective

Add the core data types to `crt-theme` that represent event overrides and sprite configurations. These types will be used by the CSS parser and renderer.

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

- [ ] `EventOverride` struct with duration, sprite_patch, sprite_overlay, and theme property fields
- [ ] `SpritePatch` struct for patching existing backdrop sprite (all fields Optional)
- [ ] `SpriteOverlay` struct for one-shot effect sprites
- [ ] `SpriteOverlayPosition` enum (Center, Cursor, Sprite, Random)
- [ ] `TerminalEvent` enum (Bell, CommandSuccess, CommandFail, FocusGained, FocusLost)
- [ ] Add `on_bell`, `on_command_fail`, `on_command_success`, `on_focus`, `on_blur` fields to Theme
- [ ] `EventOverride::merge()` method for CSS block merging
- [ ] All types derive Debug, Clone, Default where appropriate

## Implementation Notes

### File: `crates/crt-theme/src/lib.rs`

```rust
#[derive(Debug, Clone, Default)]
pub struct EventOverride {
    pub duration_ms: u32,
    pub sprite_patch: Option<SpritePatch>,
    pub sprite_overlay: Option<SpriteOverlay>,
    pub foreground: Option<Color>,
    pub background: Option<Background>,
    pub cursor_color: Option<Color>,
    pub text_shadow: Option<TextShadow>,
    pub starfield_speed: Option<f32>,
    // ... other overridable properties
}

#[derive(Debug, Clone, Default)]
pub struct SpritePatch { /* all Optional fields */ }

#[derive(Debug, Clone)]
pub struct SpriteOverlay { /* required path, optional rest */ }

pub enum TerminalEvent {
    Bell,
    CommandSuccess,
    CommandFail(i32),
    FocusGained,
    FocusLost,
}
```

### Dependencies
None - this is the foundation task.

## Status Updates

*To be added during implementation*