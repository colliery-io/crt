---
id: parse-on-event-blocks-in-css-parser
level: task
title: "Parse ::on-* event blocks in CSS parser"
short_code: "CRT-T-0137"
created_at: 2025-12-29T18:52:00.570487+00:00
updated_at: 2025-12-29T19:03:09.610855+00:00
parent: CRT-I-0016
blocked_by: []
archived: true

tags:
  - "#task"
  - "#phase/completed"


exit_criteria_met: false
strategy_id: NULL
initiative_id: CRT-I-0016
---

# Parse ::on-* event blocks in CSS parser

**Phase 2** - Extend CSS parser to recognize event pseudo-elements.

## Parent Initiative **[CONDITIONAL: Assigned Task]**

[[CRT-I-0016]]

## Objective

Extend the CSS parser in `crt-theme` to recognize and parse `::on-bell`, `::on-command-fail`, `::on-command-success`, `::on-focus`, and `::on-blur` pseudo-elements.

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

## Acceptance Criteria

- [ ] Parse `:terminal::on-bell { }` blocks
- [ ] Parse `:terminal::on-command-fail { }` blocks
- [ ] Parse `:terminal::on-command-success { }` blocks
- [ ] Parse `:terminal::on-focus { }` blocks
- [ ] Parse `:terminal::on-blur { }` blocks
- [ ] Parse `--duration: Nms` property
- [ ] Parse `--sprite-*` properties into SpritePatch
- [ ] Parse `--sprite-overlay-*` properties into SpriteOverlay
- [ ] Merge multiple blocks for same event (CSS cascade)
- [ ] Reuse existing property parsers for theme overrides

## Implementation Notes

### File: `crates/crt-theme/src/parser.rs`

Add new selector matching for event pseudo-elements:
```rust
":terminal::on-bell" => parse_event_block(input, &mut theme.on_bell),
":terminal::on-command-fail" => parse_event_block(input, &mut theme.on_command_fail),
// etc.
```

Parse `--sprite-overlay-position` values:
- `center`, `cursor`, `sprite`, `random`

### Dependencies
- CRT-T-0136 (data structures must exist first)

## Status Updates

*To be added during implementation*